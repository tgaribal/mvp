'use strict';

var mongoose = require('mongoose');
var bcrypt = require('bcrypt-nodejs');
var Promise = require('bluebird');

var UserSchema = new mongoose.Schema({
  username: {
    type: String,
    required: true,
    unique: true
  },
  password: {
    type: String,
    required: true
  }
});

User = mongoose.model('Users', UserSchema);

User.prototype.hashPassword = function (next) {
  var cipher = Promise.promisify(bcrypt.hash);
  return cipher(this.password, null, null).bind(this).then(function (hash) {
    this.password = hash;
    next();
  });
};

UserSchema.pre('save', function (next) {
  this.hashPassword(next);
});

module.exports.User = User;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NlcnZlci91c2VyTW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiYmNyeXB0IiwiUHJvbWlzZSIsIlVzZXJTY2hlbWEiLCJTY2hlbWEiLCJ1c2VybmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInVuaXF1ZSIsInBhc3N3b3JkIiwiVXNlciIsIm1vZGVsIiwicHJvdG90eXBlIiwiaGFzaFBhc3N3b3JkIiwibmV4dCIsImNpcGhlciIsInByb21pc2lmeSIsImhhc2giLCJiaW5kIiwidGhlbiIsInByZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsV0FBV0MsUUFBUSxVQUFSLENBQWY7QUFDQSxJQUFJQyxTQUFTRCxRQUFRLGVBQVIsQ0FBYjtBQUNBLElBQUlFLFVBQVVGLFFBQVEsVUFBUixDQUFkOztBQUVFLElBQUlHLGFBQWEsSUFBSUosU0FBU0ssTUFBYixDQUFvQjtBQUNuQ0MsWUFBVTtBQUNSQyxVQUFNQyxNQURFO0FBRVJDLGNBQVUsSUFGRjtBQUdSQyxZQUFRO0FBSEEsR0FEeUI7QUFNbkNDLFlBQVU7QUFDUkosVUFBTUMsTUFERTtBQUVSQyxjQUFVO0FBRkY7QUFOeUIsQ0FBcEIsQ0FBakI7O0FBWUFHLE9BQU9aLFNBQVNhLEtBQVQsQ0FBZSxPQUFmLEVBQXdCVCxVQUF4QixDQUFQOztBQUVBUSxLQUFLRSxTQUFMLENBQWVDLFlBQWYsR0FBOEIsVUFBVUMsSUFBVixFQUFnQjtBQUM1QyxNQUFJQyxTQUFTZCxRQUFRZSxTQUFSLENBQW1CaEIsT0FBT2lCLElBQTFCLENBQWI7QUFDQSxTQUFPRixPQUFPLEtBQUtOLFFBQVosRUFBc0IsSUFBdEIsRUFBNEIsSUFBNUIsRUFBa0NTLElBQWxDLENBQXVDLElBQXZDLEVBQ05DLElBRE0sQ0FDRCxVQUFTRixJQUFULEVBQWU7QUFDbkIsU0FBS1IsUUFBTCxHQUFnQlEsSUFBaEI7QUFDQUg7QUFDRCxHQUpNLENBQVA7QUFLRCxDQVBEOztBQVNBWixXQUFXa0IsR0FBWCxDQUFlLE1BQWYsRUFBdUIsVUFBU04sSUFBVCxFQUFlO0FBQ3BDLE9BQUtELFlBQUwsQ0FBa0JDLElBQWxCO0FBQ0QsQ0FGRDs7QUFJQU8sT0FBT0MsT0FBUCxDQUFlWixJQUFmLEdBQXNCQSxJQUF0QiIsImZpbGUiOiJ1c2VyTW9kZWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xudmFyIGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdC1ub2RlanMnKTtcbnZhciBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcblxuICB2YXIgVXNlclNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICAgIHVzZXJuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgIH0sXG4gICAgcGFzc3dvcmQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgfVxuICB9KTtcblxuICBVc2VyID0gbW9uZ29vc2UubW9kZWwoJ1VzZXJzJywgVXNlclNjaGVtYSk7XG5cbiAgVXNlci5wcm90b3R5cGUuaGFzaFBhc3N3b3JkID0gZnVuY3Rpb24gKG5leHQpIHtcbiAgICB2YXIgY2lwaGVyID0gUHJvbWlzZS5wcm9taXNpZnkgKGJjcnlwdC5oYXNoKTtcbiAgICByZXR1cm4gY2lwaGVyKHRoaXMucGFzc3dvcmQsIG51bGwsIG51bGwpLmJpbmQodGhpcylcbiAgICAudGhlbihmdW5jdGlvbihoYXNoKSB7XG4gICAgICB0aGlzLnBhc3N3b3JkID0gaGFzaDtcbiAgICAgIG5leHQoKTtcbiAgICB9KVxuICB9XG5cbiAgVXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbihuZXh0KSB7XG4gICAgdGhpcy5oYXNoUGFzc3dvcmQobmV4dCk7XG4gIH0pO1xuXG4gIG1vZHVsZS5leHBvcnRzLlVzZXIgPSBVc2VyOyJdfQ==